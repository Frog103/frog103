<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Frog103 - Personal Portfolio and Gallery">
<meta name="theme-color" content="#4CAF50">
<title>Frog103 - Character Design</title>
<link rel="stylesheet" href="styles.css">
<link rel="icon" type="image/x-icon" href="images/globalPageImages/frogbee.ico">
<style>
    .content-container {
        background-image: url(images/textureOne.jpeg);
        background-size: cover;
        border-radius: 5px;
        border: solid white 1px;
        max-width: 1200px;
        margin: 20px auto;
        padding: 10px;
    }
    .post-container {
        background-color: rgba(255, 255, 255, 0.6);
        border-radius: 5px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        border: solid white 1px;
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        gap: 20px;
    }
    .character-info-box {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .character-info-box h1 {
        font-size: 2.5rem;
        color: #2a5b2b;
        margin-bottom: 10px;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    .tag-container {
        display:grid;
        grid-template-columns: 1fr 1fr 1fr;
    }
    .banner-tags {
        background: #4CAF50;
        color: rgb(255, 255, 255);
        padding: 8px 15px;
        border-radius: 10px;
        font-size: 0.9em;
        transition: all 0.3s ease;
        margin: 5px 0;
        display: inline-block;
        cursor: pointer;
        text-align: center;
    }
    .character-images img {
        width: 100%;
        max-height: 800px;
        object-fit: contain;
        border-radius: 10px;
        margin: 20px 0;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    .description {
        margin-top: 20px;
        background-color: rgba(50, 61, 51, 0.75);
        color: #fff;
        padding: 15px;
        border-radius: 10px;
        line-height: 1.6;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .description p {
        margin-bottom: 10px;
    }
    .introduction-box {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin-top: 20px;
    }
    .information-nav-box {
        background-color: rgba(255, 255, 255, 0.8);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin-top: 20px;
    }
    .history-box, .trivia-box, .image-box {
        margin-top: 20px;
        background-color: rgba(50, 61, 51, 0.75);
        color: #fff;
        padding: 15px;
        border-radius: 10px;
        line-height: 1.6;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        position: relative;
    }
    .dropdown-menu {
        position: absolute;
        color: white;
        background: #333;
        border: none;
        border-radius: 8px;
        text-align: left;
        z-index: 1000;
        left: 0%;
        top: 100%;
        padding: 10px;
        width: 100%;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        opacity: 0;
        animation: fadeIn 0.3s forwards;
    }
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        box-shadow: #000000 50px 50px 50px;
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        
    }
    .modal-content {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .modal-content button {
        margin-top: 15px;
        background-color: #4CAF50;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .dropdown-menu div {
        padding: 10px;
        cursor: pointer;
        transition: background 0.3s;
    }
    
    .dropdown-menu div:hover {
        background: #555;
    }
    .resetIntro {
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: background 0.3s, transform 0.3s;
    }
    .introduction-box .description img {
        width: auto !important;
        height: auto !important;
        max-width: 100%;
        max-height: none !important;
    }

    button {
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: background 0.3s, transform 0.3s;
        margin: 5px;
    }

    @media (max-width: 768px) {
        .post-container {
            grid-template-columns: 1fr;
        }
        .tag-container {
            grid-template-columns: 1fr;
        }
        .character-images img {
            max-height: 400px;
        }
    }

    @media (max-width: 480px) {
        .header-nav-container nav ul {
            flex-direction: column;
            align-items: center;
        }
        .banner-tags {
            font-size: 0.8em;
            padding: 5px 10px;
        }
        button {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        .introduction-box .description {
            font-size: 0.9rem;
            padding: 10px;
        }
    }
    @media (max-width: 768px) {
        .dropdown-menu {
            position: relative;
            width: 100%;
            top: 0;
            left: 0;
            box-shadow: none;
            margin: 5px 0;
        }
        .dropdown-menu div {
            padding: 15px;
            font-size: 1.1rem;
        }
    }
</style>
</head>
<body class="fade-out">
    <div class="page-container">
    <div class="header-nav-container">
        <header>
            <div class="icon">
                <img src="images/frogBeeIcon.PNG" alt="Website Icon">
            </div>
            <div>
                <h1>Frog103</h1>
                <h3>Design Gallery</h3>
            </div>
        </header>
        <nav>
            <ul>
                <li><a href="index.html">Homepage</a></li>
                <li><a href="Projects.html">Products</a></li>
                <li><a href="GalleryTopic.html">Gallery</a></li>
                <li><a href="Blog.html">Blog</a></li>
                <li><a href="Contact.html">Contact</a></li>
            </ul>
        </nav>
    </div>

    <div class="content-container">
        <div class="post-container">
            <div class="character-info-box">
                <div class="header">
                    <h1>Character Name</h1>
                </div>

                <div class="tag-container">
                <div class="banner-tags">
                    <p>tag</p>
                </div>
                <div class="banner-tags">
                    <p>tag</p>
                </div>
                <div class="banner-tags">
                    <p>tag</p>
                </div>
                </div>

                <div class="character-images">
                    <img src="#" alt="Character Image" loading="lazy">
                </div>

                <div class="description">
                    Loading...
                </div>
            </div>

            <div class="introduction-box">
                <h2>Character Info</h2>
                <div class="description">
                    <p>Loading...</p>
                    <p>Description: Loading...</p>
                    <p>Time of Upload: Loading...</p>
                </div>
                <button id="resetIntro">Reset</button>
                <button id="returnButton">Return to Main Gallery</button>
            </div>
            <div class="information-nav-box">
                <h2>Additional Information</h2>
                <div class="history-box">
                    <h3>Character History</h3>
                </div>
                <div class="trivia-box">
                    <h3>Character Trivia</h3>
                </div>
                <div class="image-box">
                    <h3>Character Images</h3>
                </div>
            </div>
        </div>
    </div>

      <footer>
        Copyright &copy; 2024-2025 Frog103. All Rights Reserved.
        <p>For usage, licensing, or other inquiries, please contact me.</p>
      </footer>
    </div>
    <div id="returnModal" class="modal-overlay">
        <div class="modal-content">
            <p>This page is not available yet. Do you want to return to the Main Gallery?</p>
            <button id="modalReturnBtn">Return to Gallery</button>
        </div>
    </div>
    <script src="js/scripts.js" defer></script>
    <script src="js/particles.js" defer></script>
    <script>
    //fetch JSON, and initialize dynamic content
    document.addEventListener('DOMContentLoaded', function(){
        // Cache elements for performance
        const resetButton = document.getElementById('resetIntro');
        const returnButton = document.getElementById('returnButton');
        const characterNameElem = document.querySelector('.character-info-box h1');
        const bannerContainer = document.querySelector('.tag-container');
        const characterImageElem = document.querySelector('.character-images img');
        const infoBox = document.querySelector('.character-info-box .description');
        const introDesc = document.querySelector('.introduction-box .description');

        const params = new URLSearchParams(window.location.search);
        const charId = Number(params.get('id'));
        if (!charId) return;

        // Check showcase access
        function checkShowcaseAccess(character) {
            // Return false if showcase is set to false
            return character && String(character.showcase).toLowerCase() !== "false";
        }

        // Replace [ID#] with the image from the JSON if provided.
        function processTextContent(text, time, imagesList) {
            let processed = text.replace(/\[([^\]]+)\]/g, (match, id) => {
                if (id === "P") return ''; // Remove [P] (too lazy to remove teehee)
                const found = imagesList.find(img => img.imageId == id);
                return found ? `<img src="${found.image}" alt="${found.description || id} image" loading="lazy" style="width:100px; height:auto;">` : match;
            });
            if(time) {
                processed += `<br><strong>Time of Upload:</strong> ${time}`;
            }
            return processed;
        }
    
        fetch('json/characterDesignGallery.json')
            .then(res => res.json())
            .then(data => {
                const character = data.characters.find(c => c.characterId === charId);
                // Immediately show popup if showcase is false
                if (!checkShowcaseAccess(character)) {
                    document.getElementById('returnModal').style.display = 'flex';
                    return;
                }
    
                // Update the character name
                characterNameElem.textContent = character.name;
    
                // Clear and populate banner tags with click events to update banner image
                bannerContainer.innerHTML = "";
                if (character.pageDetails && character.pageDetails.characterBanners) {
                    character.pageDetails.characterBanners.forEach(banner => {
                        const tagDiv = document.createElement('div');
                        tagDiv.className = 'banner-tags';
                        tagDiv.innerHTML = `<p>${banner.tag}</p>`;
                        tagDiv.addEventListener('click', () => {
                            characterImageElem.src = banner.image;
                        });
                        bannerContainer.appendChild(tagDiv);
                    });
                    // Set initial banner image
                    characterImageElem.src = character.pageDetails.characterBanners[0].image;
                }
    
                // Update Character Info section with properties from characterInfo
                if (character.pageDetails && character.pageDetails.characterInfo) {
                    infoBox.innerHTML = `
                    <strong>Age:</strong> ${character.pageDetails.characterInfo.age}<br>
                    <strong>Gender:</strong> ${character.pageDetails.characterInfo.gender}<br>
                    <strong>Height:</strong> ${character.pageDetails.characterInfo.height}<br>
                    <strong>Weight:</strong> ${character.pageDetails.characterInfo.weight}<br>
                    <strong>DOB:</strong> ${character.pageDetails.characterInfo.dateOfBirth}
                    `;
                }

                // Add display for credits property
                if (character.credits) {
                    let creditsDiv = document.createElement('div');
                    creditsDiv.className = 'credits';
                    creditsDiv.innerHTML = '<strong>Artists:</strong> ' + character.credits.artists.join(', ') +
                                        '<br><strong>Extra:</strong> ' + character.credits.extra.join(', ');
                    infoBox.appendChild(creditsDiv);
                }
    
                // Store default introduction text so it can be reset later
                let defaultIntroduction = "";
    
                // Retrieve images list from the JSON file
                let imagesList = (character.pageDetails && character.pageDetails.images) || [];
    
                // Load Character Introduction text file with processing
                fetch(character.introTextFile)
                    .then(r => r.text())
                    .then(text => {
                        defaultIntroduction = processTextContent(text, undefined, imagesList);
                        introDesc.innerHTML = defaultIntroduction;
                        // Initially hide reset button
                        resetButton.style.display = 'none';
                    });
    
                // Reset introduction when reset button is clicked
                resetButton.addEventListener('click', () => {
                    introDesc.innerHTML = defaultIntroduction;
                    resetButton.style.display = 'none';
                });
    
                // Create and show dropdown menu using CSS styling from .dropdown-menu
                function showDropdown(container, items, renderOption, callback) {
                    // If container already has an active dropdown, remove it and toggle off.
                    if (container.dropdownVisible) {
                        const existingDropdown = container.querySelector('.dropdown-menu');
                        if (existingDropdown) {
                            existingDropdown.remove();
                        }
                        container.dropdownVisible = false;
                        return;
                    }
                    // Disable any other active dropdown menus.
                    document.querySelectorAll('.dropdown-menu').forEach(menu => menu.remove());
                    const dropdown = document.createElement('div');
                    dropdown.className = 'dropdown-menu';
                    items.forEach(item => {
                        const option = document.createElement('div');
                        option.classList.add('dropdown-option');
                        option.textContent = renderOption(item);
                        option.addEventListener('click', function(e){
                            e.stopPropagation();
                            dropdown.remove();
                            container.dropdownVisible = false;
                            callback(item);
                            // Show the reset button since the introduction content has been updated
                            resetButton.style.display = 'block';
                        });
                        dropdown.appendChild(option);
                    });
                    container.appendChild(dropdown);
                    container.dropdownVisible = true;
                }
    
                // History dropdown: show available history files as dropdown
                const historyBox = document.querySelector('.history-box');
                historyBox.style.cursor = "pointer";
                historyBox.addEventListener('click', () => {
                    if (character.pageDetails.history && character.pageDetails.history.length) {
                        showDropdown(historyBox, character.pageDetails.history, item => item.title, (item) => {
                            fetch(item.textFile)
                                .then(r => r.text())
                                .then(text => {
                                    introDesc.innerHTML = processTextContent(text, item.timeOfUpload, imagesList);
                                    resetButton.style.display = 'block';
                                });
                        });
                    }
                });
    
                // Trivia dropdown: show available trivia files as dropdown
                const triviaBox = document.querySelector('.trivia-box');
                triviaBox.style.cursor = "pointer";
                triviaBox.addEventListener('click', () => {
                    if (character.pageDetails.trivia && character.pageDetails.trivia.length) {
                        showDropdown(triviaBox, character.pageDetails.trivia, item => item.title, (item) => {
                            fetch(item.textFile)
                                .then(r => r.text())
                                .then(text => {
                                    introDesc.innerHTML = processTextContent(text, item.timeOfUpload, imagesList);
                                    resetButton.style.display = 'block';
                                });
                        });
                    }
                });
    
                // Image dropdown: show available images as dropdown
                const imageBox = document.querySelector('.image-box');
                if (imageBox) {
                    imageBox.style.cursor = "pointer";
                    imageBox.addEventListener('click', () => {
                        if (character.pageDetails.images && character.pageDetails.images.length) {
                            showDropdown(imageBox, character.pageDetails.images, 
                                item => item.description ? item.description : `Image ${item.imageId}`, 
                                (item) => {
                                    introDesc.innerHTML = `
                                        <img src="${item.image}" alt="${character.name} image" loading="lazy" style="width:100%; max-height:400px; margin:10px 0; border-radius:10px;">
                                        <p><strong>Description:</strong> ${item.description || 'N/A'}</p>
                                        <p><strong>Artist:</strong> ${item.artist || 'Unknown'}</p>
                                        <p><strong>Time of Upload:</strong> ${item.timeOfUpload || 'N/A'}</p>
                                    `;
                                    resetButton.style.display = 'block';
                                });
                        }
                    });
                }
            })
            .catch(err => console.error(err));
        
        // Event listener for "Return to Gallery" button
        returnButton.addEventListener('click', function(){
            document.getElementById('returnModal').style.display = 'flex';
        });
    
        // Wire up modal button to redirect to the main gallery page
        document.getElementById('modalReturnBtn').addEventListener('click', function(){
            window.location.href = 'designGallery.html';
        });
    });
    </script>
</body>
</html>
